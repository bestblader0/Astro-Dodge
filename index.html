<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>AstroDodge</title>
<style>
    body {
        margin: 0;
        background: black;
        overflow: hidden;
        color: white;
        font-family: sans-serif;
    }
    #gameCanvas {
        display: block;
        margin: auto;
        background: radial-gradient(ellipse at center, #000 0%, #020202 100%);
    }
</style>
</head>
<body>
<canvas id="gameCanvas"></canvas>
<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");

canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

let ship = {
    x: canvas.width / 2,
    y: canvas.height / 2,
    radius: 18,
    angle: 0,
    speed: 0,
    vx: 0,
    vy: 0
};

let asteroids = [];
let shields = [];
let shieldCount = 0;
let keys = {};

function createAsteroid() {
    let size = Math.random() * 30 + 20;
    let side = Math.floor(Math.random() * 4);
    let x, y;
    if (side === 0) { x = -size; y = Math.random() * canvas.height; }
    else if (side === 1) { x = canvas.width + size; y = Math.random() * canvas.height; }
    else if (side === 2) { x = Math.random() * canvas.width; y = -size; }
    else { x = Math.random() * canvas.width; y = canvas.height + size; }
    let speed = Math.random() * 1.5 + 0.5;
    let angle = Math.atan2(ship.y - y, ship.x - x);
    asteroids.push({
        x, y, size,
        vx: Math.cos(angle) * speed,
        vy: Math.sin(angle) * speed
    });
}

function createShield() {
    let x = Math.random() * canvas.width;
    let y = Math.random() * canvas.height;
    shields.push({ x, y, radius: 12 });
}

function drawShip() {
    ctx.save();
    ctx.translate(ship.x, ship.y);
    ctx.rotate(ship.angle);
    ctx.beginPath();
    ctx.moveTo(20, 0);
    ctx.lineTo(-15, -12);
    ctx.lineTo(-10, 0);
    ctx.lineTo(-15, 12);
    ctx.closePath();
    ctx.fillStyle = "#ccc";
    ctx.fill();
    ctx.strokeStyle = "#888";
    ctx.stroke();
    ctx.restore();
}

function drawAsteroid(a) {
    ctx.save();
    ctx.translate(a.x, a.y);
    ctx.beginPath();
    for (let i = 0; i < 7; i++) {
        let angle = (Math.PI * 2 / 7) * i;
        let dist = a.size + (Math.random() * 6 - 3);
        ctx.lineTo(Math.cos(angle) * dist, Math.sin(angle) * dist);
    }
    ctx.closePath();
    ctx.fillStyle = "#7a7a7a";
    ctx.fill();
    ctx.strokeStyle = "#555";
    ctx.stroke();
    ctx.restore();
}

function drawShield(s) {
    ctx.save();
    ctx.translate(s.x, s.y);
    ctx.beginPath();
    ctx.arc(0, 0, s.radius, 0, Math.PI * 2);
    ctx.fillStyle = "rgba(0, 200, 255, 0.3)";
    ctx.fill();
    ctx.strokeStyle = "cyan";
    ctx.lineWidth = 2;
    ctx.stroke();
    ctx.restore();
}

function update() {
    if (keys["ArrowUp"] || keys["w"]) {
        ship.vx += Math.cos(ship.angle) * 0.1;
        ship.vy += Math.sin(ship.angle) * 0.1;
    }
    if (keys["ArrowDown"] || keys["s"]) {
        ship.vx *= 0.98;
        ship.vy *= 0.98;
    }
    if (keys["ArrowLeft"] || keys["a"]) ship.angle -= 0.05;
    if (keys["ArrowRight"] || keys["d"]) ship.angle += 0.05;

    ship.x += ship.vx;
    ship.y += ship.vy;

    if (ship.x < 0) ship.x = canvas.width;
    if (ship.x > canvas.width) ship.x = 0;
    if (ship.y < 0) ship.y = canvas.height;
    if (ship.y > canvas.height) ship.y = 0;

    for (let a of asteroids) {
        a.x += a.vx;
        a.y += a.vy;
        if (a.x < -50 || a.x > canvas.width + 50 || a.y < -50 || a.y > canvas.height + 50) {
            asteroids.splice(asteroids.indexOf(a), 1);
        }
        let dx = ship.x - a.x;
        let dy = ship.y - a.y;
        if (Math.hypot(dx, dy) < ship.radius + a.size) {
            if (shieldCount > 0) {
                shieldCount--;
                asteroids.splice(asteroids.indexOf(a), 1);
            } else {
                alert("Game Over");
                document.location.reload();
            }
        }
    }

    for (let s of shields) {
        let dx = ship.x - s.x;
        let dy = ship.y - s.y;
        if (Math.hypot(dx, dy) < ship.radius + s.radius) {
            shieldCount++;
            shields.splice(shields.indexOf(s), 1);
        }
    }
}

function drawHUD() {
    ctx.fillStyle = "white";
    ctx.font = "20px Arial";
    ctx.fillText("Shields: " + shieldCount, 20, 30);
}

function gameLoop() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    drawShip();
    for (let a of asteroids) drawAsteroid(a);
    for (let s of shields) drawShield(s);
    drawHUD();
    update();
    requestAnimationFrame(gameLoop);
}

setInterval(createAsteroid, 1000);
setInterval(createShield, 5000);

document.addEventListener("keydown", e => keys[e.key] = true);
document.addEventListener("keyup", e => keys[e.key] = false);

gameLoop();
</script>
</body>
</html>